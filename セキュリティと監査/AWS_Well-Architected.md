
---

# ✅ 1. AWS Well-Architected セキュリティチェックリスト（Security Pillar）

AWSが推奨する「Well-Architected Framework」における**セキュリティのベストプラクティス**に基づいたチェックリストです。

## 🔐 セキュリティの6つの設計原則

| No | 原則          | チェック内容                                   |
| -- | ----------- | ---------------------------------------- |
| 1  | 最小権限の原則     | IAMポリシーが過剰に広くなっていないか（`*`の使用がないか）         |
| 2  | セキュリティレイヤー化 | ネットワーク境界・アプリ・データそれぞれに制御があるか              |
| 3  | セキュリティの自動化  | アクセス分析やログ監査が自動化されているか                    |
| 4  | データの保護      | S3、RDS、EBSなどの暗号化は有効か（KMSキーは管理されているか）     |
| 5  | インシデント対応計画  | 実行可能な対応手順と訓練が整備されているか                    |
| 6  | セキュリティの監査   | CloudTrail, Config, GuardDuty等が有効になっているか |

---

## 🧾 詳細チェックリスト例（抜粋）

| カテゴリ   | 質問                                  | 確認内容                          |
| ------ | ----------------------------------- | ----------------------------- |
| IAM    | すべてのリソースに対して最小権限のポリシーが適用されているか      | 例：不要なAdmin権限が存在しないか           |
| アクセス管理 | MFA（多要素認証）は強制されているか                 | ルートアカウントにもMFAを設定              |
| ログ     | CloudTrailは全リージョンで有効か               | S3への保存、暗号化、ログ保全期間もチェック        |
| ネットワーク | パブリックアクセスが制限されているか                  | S3のブロックパブリック設定、セキュリティグループの見直し |
| データ保護  | 保存データと通信データは暗号化されているか               | TLS, SSE-KMS, EBS暗号化など        |
| 監査     | AWS ConfigやSecurity Hubで構成が評価されているか | 不適切構成の自動通知あり                  |

---

# ✅ IAM設計例

## 1. IAMユーザー／IAMロール一覧（役割別）

| No | 種別   | 名前（例）                 | 説明               | 利用者／サービス   | MFA | 備考                    |
| -- | ---- | --------------------- | ---------------- | ---------- | --- | --------------------- |
| 1  | ユーザー | `admin-user`          | 管理者用IAMユーザー      | 情シス部門      | 有効  | ルートユーザー使用禁止           |
| 2  | ユーザー | `dev-user01`          | 開発者用ユーザー         | 開発チーム      | 有効  | 開発環境のリソース制限あり         |
| 3  | ロール  | `EC2AppAccessRole`    | EC2上アプリからS3等アクセス | EC2インスタンス  | 不要  | Instance Profileとして使用 |
| 4  | ロール  | `LambdaExecutionRole` | Lambda関数実行用      | Lambda関数   | 不要  | 権限スコープを最小化            |
| 5  | ロール  | `AdminAssumeRole`     | 開発者から昇格可能なロール    | 開発者が一時的に昇格 | 要求  | セッション時間1時間制限          |

---

## 2. IAMグループとポリシー構成例

| グループ名        | 説明      | アタッチポリシー例                                           |
| ------------ | ------- | --------------------------------------------------- |
| `AdminGroup` | 管理者全権限  | `AdministratorAccess`, `Billing`, `IAMFullAccess`   |
| `DevGroup`   | 開発用アクセス | `AmazonEC2ReadOnlyAccess`, `AWSCodeCommitPowerUser` |
| `OpsGroup`   | 運用チーム用  | `AmazonCloudWatchFullAccess`, `AmazonEC2FullAccess` |
| `AuditGroup` | 監査用アクセス | `SecurityAudit`, `AWSConfigUserAccess`              |

---

## 3. IAMポリシー設計マトリクス（環境別・サービス別の権限設計）

| 利用者・役割名               | 利用環境   | 利用サービス例                 | 権限レベル       | 備考                  |
| --------------------- | ------ | ----------------------- | ----------- | ------------------- |
| `admin-user`          | 全環境    | 全サービス                   | 管理者（フルアクセス） | CloudTrail操作含む      |
| `dev-user01`          | 開発     | EC2, Lambda, S3         | 読み書き（本番不可）  | 本番環境は明示的に拒否設定       |
| `LambdaExecutionRole` | 本番     | S3, DynamoDB            | 読み書き        | `/prod/`パス配下のみ許可    |
| `AuditGroup`          | 全環境    | CloudTrail, Config, IAM | 読み取り専用      | 書き込み操作は明示的に拒否       |
| `EC2AppAccessRole`    | ステージング | S3, Systems Manager     | 読み取り        | Session Manager実行用途 |

---

## 4. IAM設計における補足ポリシー制御ルール

| ポリシー設定項目      | 設定内容の例                                                                     |
| ------------- | -------------------------------------------------------------------------- |
| 明示的Denyの活用    | 本番環境リソースへの書き込みはすべて`Deny`を適用                                                |
| 条件付きアクセス制御    | `"Condition": {"StringEquals": {"aws:RequestedRegion": "ap-northeast-1"}}` |
| タグベース制御       | `"Condition": {"StringEquals": {"aws:ResourceTag/Env": "dev"}}`            |
| セッション時間制限     | 一時ロール昇格は最大1時間 (`"DurationSeconds": 3600`)                                  |
| セキュリティイベント検出用 | CloudTrailログへの書き込み、Configルール違反通知をIAM通知で受ける                                 |

---

## 5. ロール分離・アーキテクチャ例

| 層        | IAMロール例                  | 権限概要                             |
| -------- | ------------------------ | -------------------------------- |
| Web/AP層  | `WebAppExecutionRole`    | S3静的ファイル読込、Lambda API実行          |
| バッチ処理層   | `BatchJobLambdaRole`     | SQS書込、DynamoDB更新、ログ出力            |
| 管理者層     | `OpsAdminAssumeRole`     | セキュリティHub、Inspector、CloudTrail閲覧 |
| 開発者支援ツール | `CodeBuildExecutionRole` | ECRアクセス、CloudWatch Logs出力、S3読み書き |

---

# 📁 ご参考：IAMベストプラクティス

| 項目            | 内容                             |
| ------------- | ------------------------------ |
| ❌ ルートユーザー使用禁止 | 管理者用IAMユーザーかロールを使用する           |
| ✅ MFA強制       | 全ユーザー／ロールにMFA適用（できればハードウェアMFA） |
| 📆 ローテーション    | アクセスキーやパスワードの定期的な更新（90日以内）     |
| 🧪 アクセスアナライザー | 不要な外部アクセス（例：外部アカウントにアクセス許可）を検出 |
| 🏷️ タグ活用      | IAMリソースにもタグをつけて管理しやすくする        |

---
