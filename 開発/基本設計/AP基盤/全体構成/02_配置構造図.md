# 配置構造図

---

## AP基盤基本設計書の配置構造図作成について

### 配置構造図の概要

AP基盤基本設計書における配置構造図（デプロイメント図）は、システムの物理的な配置構成を視覚的に表現する重要な設計図です。この図面には、アプリケーションやミドルウェア、データベースなどのコンポーネントがどのサーバ゙ーやノードに配置されるかが示されます。

### 作成目的

1. **物理構成の明確化**: システムを構成する物理的な要素とその関係を明確にする
2. **リソース計画の支援**: 必要なハードウェアリソースの見積もりを支援する
3. **運用設計の基礎**: システム運用時の監視・管理設計の基礎資料として活用する

### 作成手順

#### 1. 必要な情報の収集
- システムアーキテクチャ図
- 使用するミドルウェア一覧
- サーバー仕様（物理/仮想の区別、CPU/メモリ/ストレージ要件）
- ネットワーク構成情報
- 可用性・負荷分散要件

#### 2. 配置要素の洗い出し
- アプリケーションサーバー
- Webサーバー
- データベースサーバー
- バッチ処理サーバー
- 外部連携サーバー
- キャッシュサーバー
- ロードバランサー
- ストレージ装置 など

#### 3. 図面の作成

##### 使用する記号・表記
- サーバー: 立方体またはサーバーアイコン
- クラスター: グループ化枠
- ネットワーク機器: ルーター/スイッチアイコン
- 接続線: 実線/点線で通信経路を表現

#### 記載内容
1. **物理ノードの表現**
   - サーバー名/役割
   - 仮想化の有無（VM、コンテナなど）
   - 主要スペック（CPUコア数、メモリ容量など）

2. **ソフトウェアコンポーネントの配置**
   - 各ノードに配置するアプリケーション/ミドルウェア
   - バージョン情報（必要に応じて）

3. **接続関係**
   - ノード間の通信経路
   - 通信プロトコル（HTTP, JDBC, MQなど）
   - ポート番号（重要なもののみ）

4. **冗長構成**
   - アクティブ-スタンバイ構成
   - クラスター構成
   - ロードバランシング構成

5. **ネットワーク区分**
   - DMZ/内部ネットワークの区別
   - セキュリティゾーン分け

#### 4. 補足情報の追加
- 凡例説明
- 配置方針の注記
- 特別な考慮事項（セキュリティ、性能面など）

### 作成時の注意点

1. **適切な抽象度の維持**
   - 詳細すぎず、概要が把握できるレベルに保つ
   - 複雑な場合は複数の図に分割（全体図と詳細図）

2. **一貫性のある表記**
   - 同じ要素は同じアイコン/色で表現
   - 命名規則を統一

3. **変更管理**
   - バージョン管理を徹底
   - 変更履歴を明記

4. **関連資料との整合性**
   - ネットワーク構成図やシステム構成図との整合を確認
   - アーキテクチャ図との矛盾がないようにする

### 検証ポイント

完成した配置構造図は以下の観点で検証が必要です:
1. 性能・可用性要件を満たす構成か
2. 単一障害点が存在しないか
3. セキュリティポリシーに準拠しているか
4. 今後の拡張性を考慮した設計か
5. 運用・監視の観点で問題ないか

配置構造図はシステムの物理的な基盤を表現する重要な設計図です。開発チーム、インフラチーム、運用チームが共通理解を持つための基盤となるため、正確かつわかりやすい表現を心がけることが大切です。

---

# 配置構造図の検証ポイント

配置構造図を作成した後、以下の観点で詳細に検証を行う必要があります。各ポイントを網羅的に確認することで、設計の不備や潜在的な問題を早期に発見できます。

---

## 1. 基本要件の適合性検証
- **要求仕様との整合性**: 非機能要件（性能、可用性、拡張性など）を満たす構成か
- **システム規模の適切性**: 想定ユーザー数/トランザクション量に対してリソースが適切か
- **ライセンス要件**: 使用するミドルウェアのライセンス条件に適合した配置か

## 2. 可用性・信頼性の検証
- **単一障害点(SPOF)の有無**: 重要なコンポーネントに冗長化が図られているか
- **フェイルオーバー構成**: 障害時の自動切り替え機構が設計されているか
- **負荷分散構成**: 適切なロードバランシングが設定されているか
- **バックアップ構成**: データ損失を防ぐためのバックアップ配置が含まれているか

## 3. 性能面の検証
- **リソース配分の適切性**: CPU/メモリ/ストレージ/I/Oがボトルネックにならないか
- **ネットワーク帯域**: ノード間通信に十分な帯域が確保されているか
- **キャッシュ戦略**: 適切なキャッシュレイヤーが配置されているか
- **バッチ処理影響**: バッチ実行時のオンライン処理への影響は考慮されているか

## 4. セキュリティ面の検証
- **ゾーニングの適切性**: DMZ/内部ネットワークの分離が適切か
- **通信暗号化**: 必要な通信経路に暗号化が施されているか
- **アクセス制御**: 適切なファイアウォール/セキュリティグループ設定が可能か
- **監査証跡**: 監査に必要なログ収集機構が配置されているか

## 5. 運用保守性の検証
- **監視の容易性**: 主要コンポーネントが監視システムから見える位置にあるか
- **ログ収集構成**: ログ集約のための適切な構成がなされているか
- **パッチ適用性**: OS/ミドルウェアの更新が容易な構成か
- **容量拡張の容易性**: スケールアウト/スケールアップが可能な設計か

## 6. ネットワーク構成の検証
- **ネットワーク遅延**: 地理的に分散した配置の場合、遅延が許容範囲内か
- **帯域制約**: WAN接続など帯域が限定される経路がないか
- **ルーティングの適切性**: 通信経路に不必要なホップがないか

## 7. コスト面の検証
- **リソース過不足**: 過剰なスペックや不足しているリソースがないか
- **ライセンスコスト**: 配置構成がライセンスコストを最適化しているか
- **クラウド利用時**: リージョン/アベイラビリティゾーンの選択がコストに与える影響

## 8. 将来の拡張性検証
- **水平拡張の容易性**: ユーザー数増加に対応できる拡張経路があるか
- **新機能追加の容易性**: 新しいコンポーネントを追加しやすい構成か
- **テクノロジー更新の容易性**: コンポーネントのバージョンアップが可能な設計か

## 検証方法の具体例
1. **シナリオベース検証**: 障害シナリオや負荷ピーク時の挙動をシミュレート
2. **チームレビュー**: インフラ/セキュリティ/アプリケーション各チームによる多角的レビュー
3. **プロトタイプ検証**: 重要な構成部分については実際に環境構築して検証
4. **ベンダー確認**: ハードウェア/ミドルウェアベンダーに構成の妥当性を確認

これらの検証ポイントを網羅的に確認することで、配置構造図の品質を高め、実際の構築・運用段階での問題発生リスクを大幅に低減できます。

